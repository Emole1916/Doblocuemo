<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Pro 3D Drift - Jeep Renegade</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <style>
        body { margin: 0; overflow: hidden; background: #050505; touch-action: none; font-family: sans-serif; }
        #hud { position: fixed; top: 20px; left: 20px; color: #fff; z-index: 5; background: rgba(0,0,0,0.6); padding: 15px; border-radius: 10px; border-left: 5px solid #00ffcc; }
        #controls { position: fixed; bottom: 30px; left: 0; right: 0; display: flex; justify-content: space-around; z-index: 5; pointer-events: none; }
        .btn { width: 75px; height: 75px; border-radius: 50%; background: rgba(255,255,255,0.1); color: #fff; display: flex; align-items: center; justify-content: center; font-size: 25px; border: 2px solid #00ffcc; pointer-events: auto; user-select: none; }
        .btn:active { background: #00ffcc; color: #000; }
    </style>
</head>
<body>

<div id="hud">
    VÄ°TES: <span id="gear" style="color:#00ffcc; font-weight:bold;">D</span><br>
    HIZ: <span id="speed" style="font-size:22px;">0</span> <small>km/h</small>
</div>

<div id="controls">
    <div class="btn" id="left">â¬…</div>
    <div class="btn" id="gas">â›½</div>
    <div class="btn" id="brake">ðŸ›‘</div>
    <div class="btn" id="right">âž¡</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.158/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158/examples/js/loaders/OBJLoader.js"></script>

<script>
// ===== SAHNE AYARLARI =====
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x050510);
scene.fog = new THREE.Fog(0x050510, 150, 1200);

const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 3000);
const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.shadowMap.enabled = true;
document.body.appendChild(renderer.domElement);

// ===== IÅžIKLANDIRMA =====
scene.add(new THREE.AmbientLight(0xffffff, 0.4));
const sun = new THREE.DirectionalLight(0xffffff, 1);
sun.position.set(100, 200, 100);
sun.castShadow = true;
scene.add(sun);

// ===== GELÄ°ÅžMÄ°Åž ÅžEHÄ°R HARÄ°TASI =====
const roadGeo = new THREE.PlaneGeometry(3000, 3000);
const roadMat = new THREE.MeshStandardMaterial({ color: 0x111111 });
const ground = new THREE.Mesh(roadGeo, roadMat);
ground.rotation.x = -Math.PI / 2;
ground.receiveShadow = true;
scene.add(ground);

// Izgara ve Yol Ã‡izgileri
const grid = new THREE.GridHelper(3000, 100, 0x00ffcc, 0x222222);
grid.position.y = 0.05;
scene.add(grid);

// Binalar
const box = new THREE.BoxGeometry(1, 1, 1);
for(let i=0; i<250; i++) {
    const h = 20 + Math.random() * 70;
    const w = 15 + Math.random() * 10;
    const building = new THREE.Mesh(box, new THREE.MeshStandardMaterial({ color: 0x1a1a2e }));
    building.scale.set(w, h, w);
    building.position.set((Math.random()-0.5)*1800, h/2, (Math.random()-0.5)*1800);
    if(Math.abs(building.position.x) < 25) building.position.x += 50;
    building.castShadow = true;
    scene.add(building);
}

// ===== JEEP YÃœKLEME (OBJ) =====
const carGroup = new THREE.Group();
scene.add(carGroup);

const objLoader = new THREE.OBJLoader();
// Yeni yÃ¼klediÄŸin dosya adÄ±
objLoader.load('Jeep_Renegade_2016.obj', (object) => {
    // OBJ modelleri genelde farklÄ± Ã¶lÃ§eklerde gelir, gerekirse 1,1,1 yapabilirsin
    object.scale.set(3, 3, 3); 
    
    // Modelin merkezlenmesi ve yÃ¶nÃ¼
    object.rotation.y = Math.PI; 
    
    object.traverse(child => {
        if(child.isMesh) {
            child.castShadow = true;
            child.receiveShadow = true;
            // Model kaplamasÄ±z gelirse diye varsayÄ±lan bir renk
            child.material = new THREE.MeshStandardMaterial({ color: 0x555555 });
        }
    });
    carGroup.add(object);
    console.log("Jeep BaÅŸarÄ±yla YÃ¼klendi!");
}, (xhr) => {
    console.log((xhr.loaded / xhr.total * 100) + '% yÃ¼klendi');
}, (err) => {
    console.error("YÃ¼kleme hatasÄ±!", err);
});

// ===== FÄ°ZÄ°K MOTORU =====
let speed = 0, gear = "D";
const keys = { w:0, s:0, a:0, d:0 };

// Kontroller
window.onkeydown = (e) => {
    const k = e.key.toLowerCase();
    if(k === 'w') keys.w = 1; if(k === 's') keys.s = 1;
    if(k === 'a') keys.a = 1; if(k === 'd') keys.d = 1;
    if(e.key === ' ') { gear = gear === "D" ? "R" : "D"; document.getElementById('gear').innerText = gear; }
};
window.onkeyup = (e) => {
    const k = e.key.toLowerCase();
    if(k === 'w') keys.w = 0; if(k === 's') keys.s = 0;
    if(k === 'a') keys.a = 0; if(k === 'd') keys.d = 0;
};

// Mobil Buton BaÄŸlantÄ±larÄ±
const setupBtn = (id, key) => {
    const b = document.getElementById(id);
    b.ontouchstart = (e) => { e.preventDefault(); keys[key] = 1; };
    b.ontouchend = () => keys[key] = 0;
};
setupBtn('gas', 'w'); setupBtn('brake', 's'); setupBtn('left', 'a'); setupBtn('right', 'd');

// ===== OYUN DÃ–NGÃœSÃœ =====
function loop() {
    requestAnimationFrame(loop);

    // Hareket MantÄ±ÄŸÄ±
    if(keys.w) speed += (gear === "D" ? 0.01 : -0.008);
    if(keys.s) speed *= 0.9; // Fren
    speed *= 0.97; // SÃ¼rtÃ¼nme

    const turn = 0.035 * (Math.abs(speed) > 0.02 ? 1 : 0);
    if(keys.a) carGroup.rotation.y += turn * (speed >= 0 ? 1 : -1);
    if(keys.d) carGroup.rotation.y -= turn * (speed >= 0 ? 1 : -1);

    carGroup.position.x -= Math.sin(carGroup.rotation.y) * speed * 15;
    carGroup.position.z -= Math.cos(carGroup.rotation.y) * speed * 15;

    // Kamera Takibi
    const camX = carGroup.position.x + Math.sin(carGroup.rotation.y) * 50;
    const camZ = carGroup.position.z + Math.cos(carGroup.rotation.y) * 50;
    camera.position.lerp(new THREE.Vector3(camX, 25, camZ), 0.1);
    camera.lookAt(carGroup.position);

    // HUD
    document.getElementById('speed').innerText = Math.abs(speed * 150).toFixed(0);

    renderer.render(scene, camera);
}

window.onresize = () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
};

loop();
</script>
</body>
</html>